<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">

         <!-- Bootstrap CSS CDN -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
        <link rel="stylesheet" href="style.css">

    </head>
        <body>
        <div class="wrapper">
            <!-- Sidebar Holder -->
            <nav id="sidebar">
                <div class="sidebar-header">
                    <h3>Scott Archer</h3>
                    <h5>Places I've Worked and Lived</h5>
                </div>
                <div class="container">
                <div class="navbar-btn">

                <input id="show-locations" type="button" value="show locations">
                <input id="hide-locations" type="button" value="hide locations">



                <ul class="list-unstyled component">
                        <li class="active">
                            <a href="#homeSubmenu" data-toggle="collapse" aria-expanded="false">Home</a>
                            <ul class="collapse list-unstyled" id="homeSubmenu">
                            <li><a href="#">My Family</a></li>

                        </ul>
                          <li>
                            <a href="#pageSubmenu" data-toggle="collapse" aria-expanded="false">Work</a>
                            <ul class="collapse list-unstyled" id="pageSubmenu">
                            <li><a href="#">My Work</a></li>

                        </ul>
                    </li>

                    <li>
                        <a href="#">Contact</a>
                    </li>
                </ul>
            </nav>



            <!-- Page Content Holder -->
            <div id="content">

          <script>
            var map;
            var markers = [];
            //Loads google maps location//
            function initMap() {
                map = new google.maps.Map(document.getElementById('map'), {
                  center: {
                    lat: 41.8333925,
                    lng: -88.0121478
                  },
                 zoom: 9
               });

              var locations = [
                {title: 'Des Plaines', location: {lat: 42.0228132, lng: -87.9284833}},
                {title: 'Lisle', location: {lat: 41.9665649, lng: -87.8038933}},
                {title: 'Harwood Heights', location: {lat: 41.9661792, lng: -87.8038933,}},
                {title: 'Glen Ellyn', location: {lat: 41.8535493, lng: -88.063832}},
                {title: 'Lombard', location: {lat: 41.8565625, lng: -88.0036689}},
                {title: 'Vernon Hills', location: {lat: 42.2507524, lng:-87.96064}},
                {title: 'Chicago', location: {lat: 41.8844626, lng: -87.6349813}}
              ];

              var largeInfowindow = new google.maps.InfoWindow();
              var bounds = new google.maps.LatLngBounds();
              console.log(largeInfowindow);

              var defaultIcon = makeMarkerIcon('0091ff');
              var highlightedIcon = makeMarkerIcon('ffff24');

              for (var i = 0; i < locations.length; i++) {
                //get position from array//
                var position = locations[i].location;
                var title = locations[i].title;
                console.log(position + ' : ' + title);
                var marker = new google.maps.Marker({
                  map: map, // Fixed this //
                  position: position,
                  title: title,
                  animation: google.maps.Animation.DROP,
                  icon: defaultIcon,
                  id: 'a'+i
                });

                //push marker to array of markers//
                markers.push(marker);
                //open info window//
                marker.addListener('click', function(){
                  populateInfoWindow(this, largeInfowindow);
                });
                marker.addListener('mouseover', function() {
                  this.setIcon(highlightedIcon);
                });
                marker.addListener('mouseout', function() {
                  this.setIcon(defaultIcon);
                });
              }

              document.getElementById('show-locations').addEventListener('click', showlocations);
              document.getElementById('hide-locations').addEventListener('click', hidelocations);
            }

            function populateInfoWindow(marker, infowindow) {
              if (infowindow.marker != marker) {
                infowindow.marker = marker;
                infowindow.setContent('<div>' + marker.title +'</div>');
                infowindow.open(map, marker);
                infowindow.addListener('closeclick', function(){
                  infowindow.marker = null;
                });


                var streetViewService = new google.maps.StreetViewService();
                var radius = 50;

                function getStreetView(data, status) {
                  if (status == google.maps.StreetViewStatus.OK) {
                    var nearStreetViewLocation = data.location.latLng;
                    var heading = google.maps.geometry.spherical.computeHeading(nearStreetViewLocation, marker.position);
                      infowindow.setContent('<div>' + marker.title + '</div><div id="pano"></div>');
                      var panoramaOptipons = {
                        position: nearStreetViewLocation,
                        pov: {
                          heading: heading,
                          pitch: 25
                        }
                      };
                      var panorama = new google.maps.StreetViewPanorama(document.getElementById('pano'), panoramaOptipons);
                  } else {
                    infowindow.setContent('<div>' + marker.title + '</div>' + '<div>No Street View Found</div>');
                  }
                }

                streetViewService.getPanoramaByLocation(marker.position, radius, getStreetView);
                infowindow.open(map, marker);
              }
            }

        //function to loop through markers array and render to map//
            function showlocations() {
              var bounds = new google.maps.LatLngBounds();
              for (var i = 0; i < markers.length; i++) {
                markers[i].setMap(map);
                bounds.extend(markers[i].position);
              }
              map.fitBounds(bounds);
            }
            function hidelocations() {
              for (var i = 0; i < markers.length; i++) {
                markers[i].setMap(null);
              }
            }
            function makeMarkerIcon(markerColor) {
              var markerImage = new google.maps.MarkerImage('https://chart.googleapis.com/chart?chst=d_map_spin&chld=1.15|0|'+ markerColor + '|40|_|%E2%80%A2',
                new google.maps.Size(21, 34),
                new google.maps.Point(0, 0),
                new google.maps.Point(10, 34),
                new google.maps.Size(21, 34));
               return markerImage;
            }

    </script>
    <script async defer
    src="https://maps.googleapis.com/maps/api/js?libraries=geometry&key=AIzaSyD6ZWHh5NID1cxD67I8FH43LLesybdua7c&v=3&callback=initMap">
    </script>


                <nav class="navbar navbar-default">
                    <div class="container-fluid">

                        <div class="navbar-header">
                            <button type="button" id="sidebarCollapse" class="navbar-btn">
                                <span></span>
                                <span></span>
                                <span></span>
                            </button>
                          </div>
                        </div>
                      </nav>
                          <div id="map"></div>

    </div>
</div>

        <!-- jQuery CDN -->
         <script src="https://code.jquery.com/jquery-1.12.0.min.js"></script>
         <!-- Bootstrap Js CDN -->
         <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

         <script type="text/javascript">
             $(document).ready(function () {
                 $('#sidebarCollapse').on('click', function () {
                     $('#sidebar').toggleClass('active');
                     $(this).toggleClass('active');
                 });
             });
         </script>
    </body>
</html>
